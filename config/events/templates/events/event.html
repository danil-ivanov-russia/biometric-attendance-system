{% extends "events/base.html" %}

{% block title %}{{ event.name }}{% endblock %}

{% block navbar %}{% endblock %}

{% block content %}

 <div class="row">
     <div class="col s12">
        <h2 class="center">{{ event.name }}</h2>
     </div>
 </div>
 <div class="row">
     <div class="col m0 l2"></div>
     <div class="col m12 l8">
         <div id="qrcode">
             {% include "events/qrcode.html" %}
         </div>
     </div>
     <div class="col m0 l2"></div>
 </div>

<div class="row">
    <a class="left waves-effect waves-light btn" href="{% url 'events:json' event.pk %}">Детали мероприятия в формате json</a>
</div>

<div id="attendees">
    {% include "events/attendees.html" %}
</div>



<script>
function autorefresh() {
        setInterval(function(){
            $("#attendees").load('{% url 'events:attendees' event.slug %}')
            $("#qrcode").load('{% url 'events:qrcode' event.slug %}')
    }, 1000);
}
</script>
<script>autorefresh()</script>

{% endblock %}


<!--<!DOCTYPE html>-->
<!--{% load static %}-->
<!--<html lang="ru">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>{{ event.name }}</title>-->
<!--</head>-->
<!--<body>-->
<!--<h1>{{ event.name }}</h1>-->
<!--{% load qr_code %}-->
<!--{% qr_from_text request.scheme|add:"://"|add:request.get_host|add:event.get_attendance_url size="L" %}-->
<!--<h2>Участники</h2>-->
<!--<div id="attendees" >-->
<!--    {% include "events/attendees.html" %}-->
<!--</div>-->

<!--</body>-->
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>-->
<!--&lt;!&ndash;<script src="{% static 'js/refresh.js' %}"></script>&ndash;&gt;-->
<!--<script>-->
<!--function autorefresh() {-->
<!--        setInterval(function(){-->
<!--            $("#attendees").load('{% url 'events:attendees' event.slug %}')-->
<!--    }, 2000);-->
<!--}-->
<!--</script>-->
<!--<script>autorefresh()</script>-->
<!--</html>-->